## 项目描述 -- 猫狗大战（猫狗分类）

这是 kaggle 上的一个竞赛。目标是使用深度学习方法识别图片是猫还是狗。数据来自 kaggle，数据分为训练集和测试集，训练集包含了 25000 张猫狗的图片，测试集包含了 12500 张猫狗的图片。

**数据预处理**：

- 通过对图片中的色彩-像素进行 IQR 分析，发现有些无关的图片和地分别率的图片，使用 IQR 分析异常图片的效果不是太好，经过尝试后最后选择 InceptionV3  Top-10 将训练结果和 ImageNet 构建的猫狗集合对比，排查训练集中的异常图片。处理完异常图片后将训练集中猫狗图片分别放在不同的文件夹区分，为 Keras 的 ImageDataGenerator 使用。

**评价指标**：

- 使用对数损失（Log loss）也叫交叉熵；采用交叉熵作为损失函数可以有效的解决梯度消失和梯度爆炸的问题。

**模型搭建**：

- 使用 keras 框架实现迁移学习部分。选择 ResNet50、Xception、Inception V3（综合考虑模型的分类准确率和大小）三个模型导入到 keras 进行训练生成迁移学习特征向量（导入过程要对三个模型的输入图片做 resize 224、299）。
  - ResNet：ResNet 引入了残差网络结构，通过这种残差网络结构，可以把网络层弄的很深，并且最终的分类效果也非常好（残差项原本是带权值的，但 ResNet 用恒等映射代替之 --- 将ReLU激活函数变成y=x的线性函数）
  - Inception V3：一个重要的改进是把较大的二维卷积拆成了两个较小的一维卷积，加速运算，减少过拟合，同时还更改了Inception Module的结构
  - Xception：实际上采用了类似于 ResNet 的网络结构，主体部分采用了模块化设计。Xception 是 google 继 Inception 后提出的对 Inception v3 的另一种改进，主要是采用 depthwise separable convolution（深度可分的卷积） 来替换原来 Inception v3 中的卷积操作。（两个卷积层之间是否有激活函数。 原来的 Inception 中间是有 ReLU 激活的。 但实验结果证明Xception不加激活效果更好。）

**模型训练&模型调参**：

- 载入这些特征向量，并且将它们合成一条特征向量（每个模型都将图片处理成 `1*2048` 的行向量，将这三个行向量拼接得到一个 `1*6144` 的行向量作为数据预处理的结果）。需要注意的是要用 shuffle 把数据打乱。载入预处理的数据之后，先进行一次概率为 0.5 的 dropout，然后直接连接输出层，激活函数为 Sigmoid，优化器为 Adadelta，输出一个零维张量，表示某张图片中有狗的概率。
  - 异常图片检测最开始使用色彩-像素比进行 IQR 分析筛选异常图片，后来使用 InceptionV3  Top-10 筛选，筛选结果要比 IQR 好很多，可以考虑使用更多的异常图片筛选方法然后做汇总处理异常图片。
  - 为了增强模型的泛化能力，需要对原始图片进行一些随机操作，比如旋转、剪切变换、缩放、水平翻转等。Keras 提供的图片生成器 `ImageDataGenerator` 可以很方便地对图片进行提升
  - 对模型参数的优化，通过不同的优化器的尝试得到更好的优化结果

**模型评估**：

- 可视化准确率曲线，损失函数曲线观察到的结果是准去率和 loss 在训练集和验证集上都很很好的表现。将测试集的处理结果提交到 kaggle 上，loss 为 0.04150，和验证集的 loss 近似。

**项目部署**：

- 项目使用 Keras 和 Flask 搭建部署一个简单易用的深度学习图像网页应用，可以通过网页导入一张彩色猫或者狗的图片预测是猫或者狗的概率。webapp 用 daocker 打包成了镜像文件，可以快速部署并复现实验结果。

**合理性分析**：

- Xception，InceptionV3 和 ResNet50 这三个模型进行组合迁移学习，效果比先单个神经网络模型效果好。这里利用了 bagging 的思想，通过多个模型处理数据并进行组合，可以有效降低模型的方差，减少过拟合程度，提高分类准确率。

**项目思考**：

- 项目使用的 Xception，InceptionV3 和 ResNet50 这三个模型进行了提取特征向量，然后将特征向量直接拼接，忽略了特征之间的位置关系。除了这三个模型，还可以增加更多新的模型，或者使用 stacking  的方法进行模型融合，进一步降低方差，提高分类的准确率。（还可以从原始样本上入手，有些图片的分类概率正确，但是不够确定，可以先做一部分处理，然后让模型更加确定。）